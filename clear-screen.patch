From 5337f1094ecedf50bcfb9a000ac6b99bd95ffea2 Mon Sep 17 00:00:00 2001
From: Ray Strode <rstrode@redhat.com>
Date: Fri, 14 Mar 2014 11:04:49 -0400
Subject: [PATCH 5/8] systemd: clear terminal after starting

This helps with flicker when the X server shuts down.
---
 data/gdm.service.in | 1 +
 1 file changed, 1 insertion(+)

diff --git a/data/gdm.service.in b/data/gdm.service.in
index 72201c1f..b58f4c61 100644
--- a/data/gdm.service.in
+++ b/data/gdm.service.in
@@ -1,34 +1,35 @@
 [Unit]
 Description=GNOME Display Manager
 
 # replaces the getty
 Conflicts=getty@tty@GDM_INITIAL_VT@.service
 After=getty@tty@GDM_INITIAL_VT@.service
 
 # replaces plymouth-quit since it quits plymouth on its own
 Conflicts=@PLYMOUTH_QUIT_SERVICE@
 After=@PLYMOUTH_QUIT_SERVICE@
 
 # Needs all the dependencies of the services it's replacing
 # pulled from getty@.service and @PLYMOUTH_QUIT_SERVICE@
 # (except for plymouth-quit-wait.service since it waits until
 # plymouth is quit, which we do)
 After=rc-local.service plymouth-start.service systemd-user-sessions.service
 
 # GDM takes responsibility for stopping plymouth, so if it fails
 # for any reason, make sure plymouth still stops
 OnFailure=plymouth-quit.service
 
 [Service]
 ExecStart=@sbindir@/gdm
+ExecStartPost=-/bin/bash -c "TERM=linux /usr/bin/clear > /dev/tty1"
 KillMode=mixed
 Restart=always
 IgnoreSIGPIPE=no
 BusName=org.gnome.DisplayManager
 StandardOutput=syslog
 StandardError=inherit
 EnvironmentFile=-@LANG_CONFIG_FILE@
 ExecReload=/bin/kill -SIGHUP $MAINPID
 
 [Install]
 Alias=display-manager.service
-- 
2.14.2

